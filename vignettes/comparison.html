<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="James T. Thorson and Wouter van der Bijl" />


<title>Comparison with other packages</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Comparison with other packages</h1>
<h4 class="author">James T. Thorson and Wouter van der Bijl</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(phylosem)</span></code></pre></div>
<p><code>phylosem</code> is an R package for fitting phylogenetic
structural equation models (PSEMs). The package generalizes features in
existing R packages:</p>
<ul>
<li><code>sem</code> for structural equation models (SEMs);</li>
<li><code>phylosem</code> for comparison among alternative path
models;</li>
<li><code>phylolm</code> for fitting large linear models that arise as
when specifying a SEM with one endogenous variable and multiple
exogenous and independent variables;</li>
<li><code>Rphylopars</code> for interpolating missing values when
specifying a SEM with an unstructured (full rank) covariance among
variables;</li>
</ul>
<p>In model configurations that can be fitted by both
<code>phylosem</code> and these other packages, we have confirmed that
results are nearly identical or otherwise identified reasons that
results differ.</p>
<p><code>phylosem</code> involves a simple user-interface that specifies
the SEM using notation from package <code>sem</code> and the
phylogenetic tree using package <code>ape</code>. It allows uers to
specify common models for the covariance including:</p>
<ul>
<li>Brownian motion (BM);</li>
<li>Ornstein-Uhlenbeck (OU);</li>
<li>Pagel’s lambda;</li>
<li>Pagel’s kappa;</li>
</ul>
<p>Output can be coerced to standard formats so that
<code>phylosem</code> can use plotting and summary functions form other
packages. Available output formats include:</p>
<ul>
<li><code>sem</code>, for plotting the estimated SEM and summarizing
direct and indirect effects;</li>
<li><code>phylopath</code>, for plotting and model comparison;</li>
<li><code>phylo4d</code> in R-package <code>phylobase</code> for
plotting estimated traits;</li>
</ul>
<p>Below, we specifically highlight the syntax, runtime, and output
resulting from <code>phylosem</code> and other packages.</p>
<div id="comparison-with-phylolm" class="section level2">
<h2>Comparison with phylolm</h2>
<p>We first compare syntax and run-times using simulated data against
<code>phylolm</code>. This confirms that runtimes from
<code>phylosem</code> are within an order of magnitude and that results
are nearly identical for BM, OU, delta, and kappa models.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Settings</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>Ntree <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>sd_x <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>sd_y <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>b0_x <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>b0_y <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>b_xy <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co"># Simulate tree</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>tree <span class="ot">=</span> ape<span class="sc">::</span><span class="fu">rtree</span>(<span class="at">n=</span>Ntree)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>x <span class="ot">=</span> b0_x <span class="sc">+</span> sd_x <span class="sc">*</span> phylolm<span class="sc">::</span><span class="fu">rTrait</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">phy=</span>tree)</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>ybar <span class="ot">=</span> b0_y <span class="sc">+</span> b_xy<span class="sc">*</span>x</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>y_normal <span class="ot">=</span> ybar <span class="sc">+</span> sd_y <span class="sc">*</span> phylolm<span class="sc">::</span><span class="fu">rTrait</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">phy=</span>tree)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co"># Construct, re-order, and reduce data</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>Data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span>y_normal)[]</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co"># Compare using BM model</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>plm_bm <span class="ot">=</span> phylolm<span class="sc">::</span><span class="fu">phylolm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data=</span>Data, <span class="at">phy=</span>tree, <span class="at">model=</span><span class="st">&quot;BM&quot;</span> )</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.004559994 secs</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(plm_bm)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">t.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.371</td>
<td align="right">0.214</td>
<td align="right">-1.734</td>
<td align="right">0.086</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1.117</td>
<td align="right">0.101</td>
<td align="right">11.053</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>psem_bm <span class="ot">=</span> <span class="fu">phylosem</span>( <span class="at">sem =</span> <span class="st">&quot;x -&gt; y, p&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>          <span class="at">data =</span> Data,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>          <span class="at">tree =</span> tree,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>          <span class="at">quiet =</span> <span class="cn">TRUE</span> )</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.1198878 secs</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(psem_bm)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Path</th>
<th align="left">VarName</th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">t.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NA</td>
<td align="left">Intercept_x</td>
<td align="right">1.087</td>
<td align="right">0.183</td>
<td align="right">5.945</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">Intercept_y</td>
<td align="right">-0.371</td>
<td align="right">0.213</td>
<td align="right">1.743</td>
<td align="right">0.081</td>
</tr>
<tr class="odd">
<td align="left">x -&gt; y</td>
<td align="left">p</td>
<td align="right">1.117</td>
<td align="right">0.101</td>
<td align="right">11.109</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">x &lt;-&gt; x</td>
<td align="left">V[x]</td>
<td align="right">0.315</td>
<td align="right">0.022</td>
<td align="right">14.072</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">y &lt;-&gt; y</td>
<td align="left">V[y]</td>
<td align="right">0.315</td>
<td align="right">0.022</td>
<td align="right">14.072</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># Compare using OU</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>plm_ou <span class="ot">=</span> phylolm<span class="sc">::</span><span class="fu">phylolm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data=</span>Data, <span class="at">phy=</span>tree, <span class="at">model=</span><span class="st">&quot;OUrandomRoot&quot;</span> )</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.008153915 secs</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>psem_ou <span class="ot">=</span> <span class="fu">phylosem</span>( <span class="at">sem =</span> <span class="st">&quot;x -&gt; y, p&quot;</span>,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>          <span class="at">data =</span> Data,</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>          <span class="at">tree =</span> tree,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>          <span class="at">estimate_ou =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>          <span class="at">quiet =</span> <span class="cn">TRUE</span> )</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.110199 secs</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(psem_ou)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Path</th>
<th align="left">VarName</th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">t.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NA</td>
<td align="left">Intercept_x</td>
<td align="right">1.028</td>
<td align="right">0.208</td>
<td align="right">4.946</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">Intercept_y</td>
<td align="right">-0.274</td>
<td align="right">0.235</td>
<td align="right">1.165</td>
<td align="right">0.244</td>
</tr>
<tr class="odd">
<td align="left">x -&gt; y</td>
<td align="left">p</td>
<td align="right">1.099</td>
<td align="right">0.101</td>
<td align="right">10.887</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">x &lt;-&gt; x</td>
<td align="left">V[x]</td>
<td align="right">0.332</td>
<td align="right">0.026</td>
<td align="right">12.712</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">y &lt;-&gt; y</td>
<td align="left">V[y]</td>
<td align="right">0.332</td>
<td align="right">0.026</td>
<td align="right">12.860</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(plm_ou)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">t.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.781</td>
<td align="right">0.389</td>
<td align="right">-2.006</td>
<td align="right">0.048</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1.095</td>
<td align="right">0.101</td>
<td align="right">10.850</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">c</span>( <span class="st">&quot;phylolm_alpha&quot;</span><span class="ot">=</span>plm_ou<span class="sc">$</span>optpar, </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                <span class="st">&quot;phylosem_alpha&quot;</span><span class="ot">=</span><span class="fu">exp</span>(psem_ou<span class="sc">$</span>parhat<span class="sc">$</span>lnalpha) ), <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">phylolm_alpha</td>
<td align="right">0.120</td>
</tr>
<tr class="even">
<td align="left">phylosem_alpha</td>
<td align="right">0.105</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># Compare using Pagel&#39;s lambda</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>plm_lambda <span class="ot">=</span> phylolm<span class="sc">::</span><span class="fu">phylolm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data=</span>Data, <span class="at">phy=</span>tree, <span class="at">model=</span><span class="st">&quot;lambda&quot;</span> )</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.01596212 secs</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>psem_lambda <span class="ot">=</span> <span class="fu">phylosem</span>( <span class="at">sem =</span> <span class="st">&quot;x -&gt; y, p&quot;</span>,</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>          <span class="at">data =</span> Data,</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>          <span class="at">tree =</span> tree,</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>          <span class="at">estimate_lambda =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>          <span class="at">quiet =</span> <span class="cn">TRUE</span> )</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.08768296 secs</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(psem_lambda)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Path</th>
<th align="left">VarName</th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">t.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NA</td>
<td align="left">Intercept_x</td>
<td align="right">1.092</td>
<td align="right">0.162</td>
<td align="right">6.740</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">Intercept_y</td>
<td align="right">-0.346</td>
<td align="right">0.200</td>
<td align="right">1.726</td>
<td align="right">0.084</td>
</tr>
<tr class="odd">
<td align="left">x -&gt; y</td>
<td align="left">p</td>
<td align="right">1.092</td>
<td align="right">0.103</td>
<td align="right">10.559</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">x &lt;-&gt; x</td>
<td align="left">V[x]</td>
<td align="right">0.284</td>
<td align="right">0.025</td>
<td align="right">11.367</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">y &lt;-&gt; y</td>
<td align="left">V[y]</td>
<td align="right">0.290</td>
<td align="right">0.024</td>
<td align="right">11.897</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(plm_lambda)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">t.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.356</td>
<td align="right">0.207</td>
<td align="right">-1.718</td>
<td align="right">0.089</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1.102</td>
<td align="right">0.103</td>
<td align="right">10.744</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">c</span>( <span class="st">&quot;phylolm_lambda&quot;</span><span class="ot">=</span>plm_lambda<span class="sc">$</span>optpar, </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                <span class="st">&quot;phylosem_lambda&quot;</span><span class="ot">=</span><span class="fu">plogis</span>(psem_lambda<span class="sc">$</span>parhat<span class="sc">$</span>logitlambda) ), <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">phylolm_lambda</td>
<td align="right">0.980</td>
</tr>
<tr class="even">
<td align="left">phylosem_lambda</td>
<td align="right">0.957</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># Compare using Pagel&#39;s kappa</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>plm_kappa <span class="ot">=</span> phylolm<span class="sc">::</span><span class="fu">phylolm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data=</span>Data, <span class="at">phy=</span>tree, <span class="at">model=</span><span class="st">&quot;kappa&quot;</span>, <span class="at">lower.bound =</span> <span class="dv">0</span>, <span class="at">upper.bound =</span> <span class="dv">3</span> )</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.004805803 secs</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>psem_kappa <span class="ot">=</span> <span class="fu">phylosem</span>( <span class="at">sem =</span> <span class="st">&quot;x -&gt; y, p&quot;</span>,</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>          <span class="at">data =</span> Data,</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>          <span class="at">tree =</span> tree,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>          <span class="at">estimate_kappa =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>          <span class="at">quiet =</span> <span class="cn">TRUE</span> )</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.08613515 secs</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(psem_kappa)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Path</th>
<th align="left">VarName</th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">t.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NA</td>
<td align="left">Intercept_x</td>
<td align="right">1.078</td>
<td align="right">0.186</td>
<td align="right">5.783</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">Intercept_y</td>
<td align="right">-0.368</td>
<td align="right">0.216</td>
<td align="right">1.705</td>
<td align="right">0.088</td>
</tr>
<tr class="odd">
<td align="left">x -&gt; y</td>
<td align="left">p</td>
<td align="right">1.113</td>
<td align="right">0.101</td>
<td align="right">11.025</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">x &lt;-&gt; x</td>
<td align="left">V[x]</td>
<td align="right">0.299</td>
<td align="right">0.029</td>
<td align="right">10.183</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">y &lt;-&gt; y</td>
<td align="left">V[y]</td>
<td align="right">0.300</td>
<td align="right">0.029</td>
<td align="right">10.343</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(plm_kappa)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">t.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.370</td>
<td align="right">0.216</td>
<td align="right">-1.716</td>
<td align="right">0.089</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1.115</td>
<td align="right">0.101</td>
<td align="right">11.015</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">c</span>( <span class="st">&quot;phylolm_kappa&quot;</span><span class="ot">=</span>plm_kappa<span class="sc">$</span>optpar, </span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                <span class="st">&quot;phylosem_kappa&quot;</span><span class="ot">=</span><span class="fu">exp</span>(psem_kappa<span class="sc">$</span>parhat<span class="sc">$</span>lnkappa) ), <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">phylolm_kappa</td>
<td align="right">0.930</td>
</tr>
<tr class="even">
<td align="left">phylosem_kappa</td>
<td align="right">0.857</td>
</tr>
</tbody>
</table>
</div>
<div id="generalized-linear-models" class="section level2">
<h2>Generalized linear models</h2>
<p>We also compare results among software for fitting phylogenetic
generalized linear models (PGLM).</p>
<div id="poisson-distributed-response" class="section level3">
<h3>Poisson-distributed response</h3>
<p>First, we specifically explore a Poisson-distributed PGLM, comparing
<code>phylosem</code> against <code>phylolm::phyloglm</code> (which uses
Generalized Estimating Equations) and <code>phyr::pglmm_compare</code>
(which uses maximum likelihood).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Settings</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>Ntree <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>sd_x <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>sd_y <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>b0_x <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>b0_y <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>b_xy <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co"># Simulate tree</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>tree <span class="ot">=</span> ape<span class="sc">::</span><span class="fu">rtree</span>(<span class="at">n=</span>Ntree)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>x <span class="ot">=</span> b0_x <span class="sc">+</span> sd_x <span class="sc">*</span> phylolm<span class="sc">::</span><span class="fu">rTrait</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">phy=</span>tree)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>ybar <span class="ot">=</span> b0_y <span class="sc">+</span> b_xy<span class="sc">*</span>x</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>y_normal <span class="ot">=</span> ybar <span class="sc">+</span> sd_y <span class="sc">*</span> phylolm<span class="sc">::</span><span class="fu">rTrait</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">phy=</span>tree)</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>y_pois <span class="ot">=</span> <span class="fu">rpois</span>( <span class="at">n=</span>Ntree, <span class="at">lambda=</span><span class="fu">exp</span>(y_normal) )</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co"># Construct, re-order, and reduce data</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>Data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span>y_pois)</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co"># Compare using phylolm::phyloglm</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>pglm <span class="ot">=</span> phylolm<span class="sc">::</span><span class="fu">phyloglm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data=</span>Data, <span class="at">phy=</span>tree, <span class="at">method=</span><span class="st">&quot;poisson_GEE&quot;</span> )</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(pglm)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">z.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-1.098</td>
<td align="right">0.633</td>
<td align="right">-1.736</td>
<td align="right">0.083</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1.314</td>
<td align="right">0.247</td>
<td align="right">5.320</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>pglmm <span class="ot">=</span> phyr<span class="sc">::</span><span class="fu">pglmm_compare</span>(</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="at">data =</span> Data,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="at">phy =</span> tree )</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(pglmm), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; Generalized linear mixed model for poisson data fit by restricted maximum likelihood</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; Call:y ~ 1 + x</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; logLik    AIC    BIC </span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; -173.4  354.7  360.6 </span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; Phylogenetic random effects variance (s2):</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt;    Variance Std.Dev</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; s2  0.05511  0.2348</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt;                Value Std.Error  Zscore    Pvalue    </span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.57009   0.30469 -1.8710   0.06134 .  </span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; x            1.18137   0.19807  5.9645 2.454e-09 ***</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>pgsem <span class="ot">=</span> <span class="fu">phylosem</span>( <span class="at">sem =</span> <span class="st">&quot;x -&gt; y, p&quot;</span>,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>          <span class="at">data =</span> Data,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>          <span class="at">family =</span> <span class="fu">c</span>(<span class="st">&quot;fixed&quot;</span>,<span class="st">&quot;poisson&quot;</span>),</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>          <span class="at">tree =</span> tree,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>          <span class="at">quiet =</span> <span class="cn">TRUE</span> )</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(pgsem)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Path</th>
<th align="left">VarName</th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">t.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NA</td>
<td align="left">Intercept_x</td>
<td align="right">1.087</td>
<td align="right">0.183</td>
<td align="right">5.945</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">Intercept_y</td>
<td align="right">-0.581</td>
<td align="right">0.305</td>
<td align="right">1.904</td>
<td align="right">0.057</td>
</tr>
<tr class="odd">
<td align="left">x -&gt; y</td>
<td align="left">p</td>
<td align="right">1.190</td>
<td align="right">0.199</td>
<td align="right">5.971</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">x &lt;-&gt; x</td>
<td align="left">V[x]</td>
<td align="right">0.315</td>
<td align="right">0.022</td>
<td align="right">14.072</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">y &lt;-&gt; y</td>
<td align="left">V[y]</td>
<td align="right">0.232</td>
<td align="right">0.054</td>
<td align="right">4.310</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<p>We also compare results against <code>brms</code> (which fits a
Bayesian hierarchical model), although we load results from compiled run
of <code>brms</code> to avoid users having to install STAN to run
vignettes for <code>phylosem</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Comare using Bayesian implementation in brms</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>Amat <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">vcv.phylo</span>(tree)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>Data<span class="sc">$</span>tips <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Data)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>mcmc <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> <span class="fu">gr</span>(tips, <span class="at">cov =</span> A)),</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="at">data =</span> Data, <span class="at">data2 =</span> <span class="fu">list</span>(<span class="at">A =</span> Amat),</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&#39;poisson&#39;</span>,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>)</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">fixef</span>(mcmc), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co"># Plot them together</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>pdat <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="fu">coef</span>(<span class="fu">summary</span>(pglm))[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Estimate =</span> pglmm<span class="sc">$</span>B, <span class="at">StdErr =</span> pglmm<span class="sc">$</span>B.se),</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">as.data.frame</span>(<span class="fu">fixef</span>(mcmc))[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="fu">c</span>(<span class="st">&#39;Estimate&#39;</span>, <span class="st">&#39;StdErr&#39;</span>)),</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">summary</span>(pgsem)<span class="sc">$</span>coefficients[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], <span class="fu">c</span>(<span class="st">&#39;Estimate&#39;</span>, <span class="st">&#39;StdErr&#39;</span>))</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>)</span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>pdat<span class="sc">$</span>Param <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Intercept&#39;</span>, <span class="st">&#39;Slope&#39;</span>), <span class="dv">4</span>)</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>pdat<span class="sc">$</span>Method <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="st">&#39;phylolm::phyloglm&#39;</span>, <span class="st">&#39;phyr::pglmm_compare&#39;</span>,</span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>                     <span class="st">&#39;brms::brm&#39;</span>, <span class="st">&#39;phylosem::phylosem&#39;</span>), <span class="at">each =</span> <span class="dv">2</span>)</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>figure <span class="ot">=</span> <span class="fu">ggplot</span>(pdat, <span class="fu">aes</span>(</span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>  <span class="at">x =</span> Estimate, <span class="at">xmin =</span> Estimate <span class="sc">-</span> StdErr,</span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a>  <span class="at">xmax =</span> Estimate <span class="sc">+</span> StdErr, <span class="at">y =</span> Param, <span class="at">color =</span> Method</span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor.x =</span> <span class="fu">element_line</span>())</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="75%" /></p>
<p>In this instance (and in others we have explored), results from
<code>phylolm::phyloglm</code> are generally different while those from
<code>phylosem</code>, <code>phyr::pglmm_compare</code>, and
<code>brms</code> are close but not quite identical.</p>
</div>
<div id="binomial-regression" class="section level3">
<h3>Binomial regression</h3>
<p>We also compare results for a Bernoulli-distributed response using
PGLM. We again compare <code>phylosem</code> against
<code>phyr::pglmm_compare</code>, and do not explore threshold models
which we expect to give different results due differences in assumptions
about how latent variables affect measurements.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Settings</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>Ntree <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>sd_x <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>sd_y <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>b0_x <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>b0_y <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>b_xy <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co"># Simulate tree</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>tree <span class="ot">=</span> ape<span class="sc">::</span><span class="fu">rtree</span>(<span class="at">n=</span>Ntree)</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>x <span class="ot">=</span> b0_x <span class="sc">+</span> sd_x <span class="sc">*</span> phylolm<span class="sc">::</span><span class="fu">rTrait</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">phy=</span>tree)</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>ybar <span class="ot">=</span> b0_y <span class="sc">+</span> b_xy<span class="sc">*</span>x</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>y_normal <span class="ot">=</span> ybar <span class="sc">+</span> sd_y <span class="sc">*</span> phylolm<span class="sc">::</span><span class="fu">rTrait</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">phy=</span>tree)</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>y_binom <span class="ot">=</span> <span class="fu">rbinom</span>( <span class="at">n=</span>Ntree, <span class="at">size=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="fu">plogis</span>(y_normal) )</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co"># Construct, re-order, and reduce data</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>Data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span>y_binom)</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>pglmm <span class="ot">=</span> phyr<span class="sc">::</span><span class="fu">pglmm_compare</span>(</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>  y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,</span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>  <span class="at">data =</span> Data,</span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>  <span class="at">phy =</span> tree )</span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(pglmm), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co">#&gt; Generalized linear mixed model for binomial data fit by restricted maximum likelihood</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a><span class="co">#&gt; Call:y ~ 1 + x</span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="co">#&gt; logLik    AIC    BIC </span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a><span class="co">#&gt; -63.74 135.47 141.32 </span></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a><span class="co">#&gt; Phylogenetic random effects variance (s2):</span></span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a><span class="co">#&gt;    Variance Std.Dev</span></span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a><span class="co">#&gt; s2   0.1076   0.328</span></span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a><span class="co">#&gt;               Value Std.Error Zscore Pvalue</span></span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a><span class="co">#&gt; (Intercept) 0.23179   0.60507 0.3831 0.7017</span></span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a><span class="co">#&gt; x           0.44548   0.45708 0.9746 0.3297</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>pgsem <span class="ot">=</span> <span class="fu">phylosem</span>( <span class="at">sem =</span> <span class="st">&quot;x -&gt; y, p&quot;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>          <span class="at">data =</span> Data,</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>          <span class="at">family =</span> <span class="fu">c</span>(<span class="st">&quot;fixed&quot;</span>,<span class="st">&quot;binomial&quot;</span>),</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>          <span class="at">tree =</span> tree,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>          <span class="at">quiet =</span> <span class="cn">TRUE</span> )</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(pgsem)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Path</th>
<th align="left">VarName</th>
<th align="right">Estimate</th>
<th align="right">StdErr</th>
<th align="right">t.value</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NA</td>
<td align="left">Intercept_x</td>
<td align="right">1.087</td>
<td align="right">0.183</td>
<td align="right">5.945</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">Intercept_y</td>
<td align="right">0.204</td>
<td align="right">0.589</td>
<td align="right">0.346</td>
<td align="right">0.730</td>
</tr>
<tr class="odd">
<td align="left">x -&gt; y</td>
<td align="left">p</td>
<td align="right">0.458</td>
<td align="right">0.468</td>
<td align="right">0.977</td>
<td align="right">0.328</td>
</tr>
<tr class="even">
<td align="left">x &lt;-&gt; x</td>
<td align="left">V[x]</td>
<td align="right">-0.315</td>
<td align="right">0.022</td>
<td align="right">14.072</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">y &lt;-&gt; y</td>
<td align="left">V[y]</td>
<td align="right">0.290</td>
<td align="right">0.284</td>
<td align="right">1.020</td>
<td align="right">0.308</td>
</tr>
</tbody>
</table>
<p>In this instance, <code>phylosem</code> and
<code>phyr::pglmm_compare</code> give similar estimates and standard
errors for the slope term.</p>
</div>
<div id="summary-of-pglm-results" class="section level3">
<h3>Summary of PGLM results</h3>
<p>Based on these two comparisons, we conclude that phylosem provides an
interface for maximum-likelihood estimate of phylogenetic generalized
linear models (PGLM), and extends this class to include mixed data
(i.e., a combination of different measurement types), missing data, and
non-recursive structural linkages. However, we also encourage further
cross-testing of different software for fitting phylogenetic generalized
linear models.</p>
</div>
</div>
<div id="compare-with-phylopath" class="section level2">
<h2>Compare with phylopath</h2>
<p>We next compare with a single run of <code>phylopath</code>. This
again confirms that runtimes are within an order of magnitude and
results are identical for standardized or unstandardized
coefficients.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">library</span>(phylopath)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">library</span>(phylosem)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># make copy of data that&#39;s rescaled</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>rhino_scaled <span class="ot">=</span> rhino</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  rhino_scaled[,<span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;NL&quot;</span>,<span class="st">&quot;LS&quot;</span>,<span class="st">&quot;DD&quot;</span>,<span class="st">&quot;RS&quot;</span>)] <span class="ot">=</span> <span class="fu">scale</span>(rhino_scaled[,<span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;NL&quot;</span>,<span class="st">&quot;LS&quot;</span>,<span class="st">&quot;DD&quot;</span>,<span class="st">&quot;RS&quot;</span>)])</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co"># Fit and plot using phylopath</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">DAG</span>(RS <span class="sc">~</span> DD, LS <span class="sc">~</span> BM, NL <span class="sc">~</span> BM, DD <span class="sc">~</span> NL)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">est_DAG</span>( <span class="at">DAG =</span> dag,</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>                    <span class="at">data =</span> rhino,</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>                    <span class="at">tree =</span> rhino_tree,</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>,</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>                    <span class="at">measurement_error =</span> <span class="cn">FALSE</span> )</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.007582188 secs</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co"># Fit and plot using phylosem</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>model <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="st">  DD -&gt; RS, p1</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="st">  BM -&gt; LS, p2</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="st">  BM -&gt; NL, p3</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="st">  NL -&gt; DD, p4</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>psem <span class="ot">=</span> <span class="fu">phylosem</span>( <span class="at">sem =</span> model,</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>          <span class="at">data =</span> rhino_scaled[,<span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;NL&quot;</span>,<span class="st">&quot;DD&quot;</span>,<span class="st">&quot;RS&quot;</span>,<span class="st">&quot;LS&quot;</span>)],</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>          <span class="at">tree =</span> rhino_tree,</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>          <span class="at">quiet =</span> <span class="cn">TRUE</span> )</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.1717031 secs</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="fu">plot</span>( <span class="fu">as_fitted_DAG</span>(psem) )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="comparison-with-sem" class="section level2">
<h2>Comparison with sem</h2>
<p>We next compare syntax and runtime against R-package
<code>sem</code>. This confirms that runtimes are within an order of
magnitude when specifying a star-phylogeny in <code>phylosem</code> to
match the assumed structure in <code>sem</code></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">library</span>(sem)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">library</span>(TreeTools)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co"># Simulation parameters</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>n_obs <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co"># Intercepts</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>a1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>a2 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>a3 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>a4 <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co"># Slopes</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>b12 <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>b23 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>b34 <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co"># Standard deviations</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>s1 <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>s2 <span class="ot">=</span> <span class="fl">0.2</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>s3 <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>s4 <span class="ot">=</span> <span class="fl">0.4</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>E1 <span class="ot">=</span> <span class="fu">rnorm</span>(n_obs, <span class="at">sd=</span>s1)</span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>E2 <span class="ot">=</span> <span class="fu">rnorm</span>(n_obs, <span class="at">sd=</span>s2)</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>E3 <span class="ot">=</span> <span class="fu">rnorm</span>(n_obs, <span class="at">sd=</span>s3)</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>E4 <span class="ot">=</span> <span class="fu">rnorm</span>(n_obs, <span class="at">sd=</span>s4)</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a>Y1 <span class="ot">=</span> a1 <span class="sc">+</span> E1</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a>Y2 <span class="ot">=</span> a2 <span class="sc">+</span> b12<span class="sc">*</span>Y1 <span class="sc">+</span> E2</span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>Y3 <span class="ot">=</span> a3 <span class="sc">+</span> b23<span class="sc">*</span>Y2 <span class="sc">+</span> E3</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a>Y4 <span class="ot">=</span> a4 <span class="sc">+</span> b34<span class="sc">*</span>Y3 <span class="sc">+</span> E4</span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a>Data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Y1=</span>Y1, <span class="at">Y2=</span>Y2, <span class="at">Y3=</span>Y3, <span class="at">Y4=</span>Y4)</span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a><span class="co"># Specify path diagram (in this case, using correct structure)</span></span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a>equations <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a><span class="st">  Y2 = b12 * Y1</span></span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a><span class="st">  Y4 = b34 * Y3</span></span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">specifyEquations</span>(<span class="at">text=</span>equations, <span class="at">exog.variances=</span><span class="cn">TRUE</span>, <span class="at">endog.variances=</span><span class="cn">TRUE</span>)</span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a><span class="co"># Fit using package:sem</span></span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a>Sem <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data=</span>Data)</span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.01143217 secs</span></span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a><span class="co"># Specify star phylogeny</span></span>
<span id="cb21-46"><a href="#cb21-46" tabindex="-1"></a>tree_null <span class="ot">=</span> TreeTools<span class="sc">::</span><span class="fu">StarTree</span>(n_obs)</span>
<span id="cb21-47"><a href="#cb21-47" tabindex="-1"></a>  tree_null<span class="sc">$</span>edge.length <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(tree_null<span class="sc">$</span>edge))</span>
<span id="cb21-48"><a href="#cb21-48" tabindex="-1"></a>  <span class="fu">rownames</span>(Data) <span class="ot">=</span> tree_null<span class="sc">$</span>tip.label</span>
<span id="cb21-49"><a href="#cb21-49" tabindex="-1"></a></span>
<span id="cb21-50"><a href="#cb21-50" tabindex="-1"></a><span class="co"># Fit using phylosem</span></span>
<span id="cb21-51"><a href="#cb21-51" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb21-52"><a href="#cb21-52" tabindex="-1"></a>psem <span class="ot">=</span> <span class="fu">phylosem</span>( <span class="at">data =</span> Data,</span>
<span id="cb21-53"><a href="#cb21-53" tabindex="-1"></a>          <span class="at">sem =</span> equations,</span>
<span id="cb21-54"><a href="#cb21-54" tabindex="-1"></a>          <span class="at">tree =</span> tree_null,</span>
<span id="cb21-55"><a href="#cb21-55" tabindex="-1"></a>          <span class="at">quiet =</span> <span class="cn">TRUE</span> )</span>
<span id="cb21-56"><a href="#cb21-56" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb21-57"><a href="#cb21-57" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.03338599 secs</span></span></code></pre></div>
<p>We then compare estimated values for standardized coefficients</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">b12</td>
<td align="right">0.326</td>
</tr>
<tr class="even">
<td align="left">b34</td>
<td align="right">0.325</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="left">Path</th>
<th align="left">Parameter</th>
<th align="right">Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Y1 -&gt; Y2</td>
<td align="left">b12</td>
<td align="right">0.345</td>
</tr>
<tr class="even">
<td align="left">Y3 -&gt; Y4</td>
<td align="left">b34</td>
<td align="right">0.343</td>
</tr>
</tbody>
</table>
<p>and also compare values for unstandardized coefficients:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">b12</td>
<td align="right">0.660</td>
</tr>
<tr class="even">
<td align="left">b34</td>
<td align="right">0.390</td>
</tr>
<tr class="odd">
<td align="left">V[Y1]</td>
<td align="right">0.010</td>
</tr>
<tr class="even">
<td align="left">V[Y2]</td>
<td align="right">0.038</td>
</tr>
<tr class="odd">
<td align="left">V[Y3]</td>
<td align="right">0.098</td>
</tr>
<tr class="even">
<td align="left">V[Y4]</td>
<td align="right">0.126</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="left">Path</th>
<th align="left">Parameter</th>
<th align="right">Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Y1 -&gt; Y2</td>
<td align="left">b12</td>
<td align="right">0.660</td>
</tr>
<tr class="even">
<td align="left">Y3 -&gt; Y4</td>
<td align="left">b34</td>
<td align="right">0.390</td>
</tr>
<tr class="odd">
<td align="left">Y1 &lt;-&gt; Y1</td>
<td align="left">V[Y1]</td>
<td align="right">0.010</td>
</tr>
<tr class="even">
<td align="left">Y2 &lt;-&gt; Y2</td>
<td align="left">V[Y2]</td>
<td align="right">0.038</td>
</tr>
<tr class="odd">
<td align="left">Y3 &lt;-&gt; Y3</td>
<td align="left">V[Y3]</td>
<td align="right">0.098</td>
</tr>
<tr class="even">
<td align="left">Y4 &lt;-&gt; Y4</td>
<td align="left">V[Y4]</td>
<td align="right">0.126</td>
</tr>
</tbody>
</table>
</div>
<div id="comparison-with-rphylopars" class="section level2">
<h2>Comparison with Rphylopars</h2>
<p>Finally, we compare syntax and runtime against R-package
<code>Rphylopars</code>. This confirms that we can impute identical
estimates using both packages, when specifying a full-rank covariance in
<code>phylosem</code></p>
<p>We note that <code>phylosem</code> also allows parsimonious
representations of the trait covariance via the inputted SEM
structure.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">library</span>(Rphylopars)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co"># Format data, within no values for species t1</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>Data <span class="ot">=</span> rhino[,<span class="fu">c</span>(<span class="st">&quot;BM&quot;</span>,<span class="st">&quot;NL&quot;</span>,<span class="st">&quot;DD&quot;</span>,<span class="st">&quot;RS&quot;</span>,<span class="st">&quot;LS&quot;</span>)]</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="fu">rownames</span>(Data) <span class="ot">=</span> tree<span class="sc">$</span>tip.label</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>Data[<span class="st">&#39;t1&#39;</span>,] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co"># fit using phylopars</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">phylopars</span>( <span class="at">trait_data =</span> <span class="fu">cbind</span>(<span class="at">species=</span><span class="fu">rownames</span>(Data),Data),</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>                  <span class="at">tree =</span> tree,</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>                  <span class="at">pheno_error =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>                  <span class="at">phylo_correlated =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>                  <span class="at">pheno_correlated =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.08701205 secs</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co"># Display estimates for missing values</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>( <span class="st">&quot;Estimate&quot;</span><span class="ot">=</span>pars<span class="sc">$</span>anc_recon[<span class="st">&quot;t1&quot;</span>,], <span class="st">&quot;Var&quot;</span><span class="ot">=</span>pars<span class="sc">$</span>anc_var[<span class="st">&quot;t1&quot;</span>,] ), <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">BM</td>
<td align="right">1.266</td>
<td align="right">1.941</td>
</tr>
<tr class="even">
<td align="left">NL</td>
<td align="right">1.600</td>
<td align="right">1.856</td>
</tr>
<tr class="odd">
<td align="left">DD</td>
<td align="right">2.301</td>
<td align="right">1.708</td>
</tr>
<tr class="even">
<td align="left">RS</td>
<td align="right">0.431</td>
<td align="right">1.909</td>
</tr>
<tr class="odd">
<td align="left">LS</td>
<td align="right">1.083</td>
<td align="right">1.347</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co"># fit using phylosem</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>start_time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>psem <span class="ot">=</span> <span class="fu">phylosem</span>( <span class="at">data =</span> Data,</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>                 <span class="at">tree =</span> tree,</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>                 <span class="at">sem =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>                 <span class="at">covs =</span> <span class="st">&quot;BM, NL, DD, RS, LS&quot;</span>,</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>                 <span class="at">quiet =</span> <span class="cn">TRUE</span> )</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start_time</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.2911081 secs</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co"># Display estimates for missing values</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>  <span class="st">&quot;Estimate&quot;</span><span class="ot">=</span><span class="fu">as.list</span>(psem<span class="sc">$</span>opt<span class="sc">$</span>SD,<span class="st">&quot;Estimate&quot;</span>)<span class="sc">$</span>x_vj[ <span class="fu">match</span>(<span class="st">&quot;t1&quot;</span>,tree<span class="sc">$</span>tip.label), ],</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>  <span class="st">&quot;Var&quot;</span><span class="ot">=</span><span class="fu">as.list</span>(psem<span class="sc">$</span>opt<span class="sc">$</span>SD,<span class="st">&quot;Std. Error&quot;</span>)<span class="sc">$</span>x_vj[ <span class="fu">match</span>(<span class="st">&quot;t1&quot;</span>,tree<span class="sc">$</span>tip.label), ]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>), <span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Estimate</th>
<th align="right">Var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.266</td>
<td align="right">1.941</td>
</tr>
<tr class="even">
<td align="right">1.600</td>
<td align="right">1.856</td>
</tr>
<tr class="odd">
<td align="right">2.301</td>
<td align="right">1.708</td>
</tr>
<tr class="even">
<td align="right">0.431</td>
<td align="right">1.910</td>
</tr>
<tr class="odd">
<td align="right">1.083</td>
<td align="right">1.347</td>
</tr>
</tbody>
</table>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
